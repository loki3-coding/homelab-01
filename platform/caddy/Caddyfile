# Caddyfile - Reverse Proxy Configuration for Homelab
# Handles HTTPS/TLS termination and routes traffic to internal services

# Global options
{
	# Email for Let's Encrypt notifications
	email admin@homelab.com

	# Use internal Caddy CA for development/internal use
	# Comment this out if using Let's Encrypt
	local_certs

	# For Let's Encrypt with DNS-01 challenge (external domains)
	# Uncomment and configure based on your DNS provider:
	# acme_dns cloudflare {env.CLOUDFLARE_API_TOKEN}
}

# Immich - Photo Management
immich.homelab.com {
	reverse_proxy immich-server:2283

	# Enable logging
	log {
		output file /data/logs/immich.log
		format json
	}
}

# Gitea - Git Service
gitea.homelab.com {
	reverse_proxy gitea:3000

	log {
		output file /data/logs/gitea.log
		format json
	}
}

# Grafana - Monitoring Dashboard
grafana.homelab.com {
	reverse_proxy grafana:3000

	log {
		output file /data/logs/grafana.log
		format json
	}
}

# Prometheus - Metrics
prometheus.homelab.com {
	reverse_proxy prometheus:9090

	log {
		output file /data/logs/prometheus.log
		format json
	}
}

# Loki - Log Aggregation
loki.homelab.com {
	reverse_proxy loki:3100

	log {
		output file /data/logs/loki.log
		format json
	}
}

# Homepage - Dashboard
home.homelab.com {
	reverse_proxy homepage:3000

	log {
		output file /data/logs/homepage.log
		format json
	}
}

# Portainer - Docker Management UI
portainer.homelab.com {
	reverse_proxy portainer:9000

	log {
		output file /data/logs/portainer.log
		format json
	}
}

# Pi-hole - DNS & Ad Blocking
pihole.homelab.com {
	reverse_proxy 172.18.0.1:8080

	log {
		output file /data/logs/pihole.log
		format json
	}
}
